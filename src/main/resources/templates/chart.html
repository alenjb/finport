<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>거래 내역 차트</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">
<h2>📈 체결 가격 변동 차트</h2>

<form th:action="@{/chart}" method="get" class="row g-3 mb-4">
    <div class="col-md-6">
        <select name="stockId" class="form-select">
            <option th:each="s : ${stocks}" th:value="${s.id}" th:text="${s.name}"
                    th:selected="${selectedStock != null and s.id == selectedStock.id}">종목 선택</option>
        </select>
    </div>
    <div class="col-md-3">
        <button class="btn btn-primary">조회</button>
    </div>
</form>

<div th:if="${timestamps}" class="card p-3">
    <canvas id="priceChart"></canvas>
</div>

<script th:inline="javascript">
    const labels = [[${timestamps}]];
    const data = {
        labels: labels,
        datasets: [{
            label: '체결 가격',
            data: [[${prices}]],
            fill: false,
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.1
        }]
    };
    new Chart(document.getElementById('priceChart'), {
        type: 'line',
        data: data
    });
</script>
</body>
</html>